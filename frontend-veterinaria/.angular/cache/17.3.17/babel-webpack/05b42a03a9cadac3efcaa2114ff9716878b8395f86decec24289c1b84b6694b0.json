{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/pago.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction PagoListComponent_button_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function PagoListComponent_button_13_Template_button_click_0_listener() {\n      const f_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.cambiarFiltro(f_r2));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const f_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"btn-primary\", ctx_r2.filtro === f_r2)(\"btn-outline-primary\", ctx_r2.filtro !== f_r2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", f_r2, \" \");\n  }\n}\nfunction PagoListComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"div\", 17)(2, \"span\", 18);\n    i0.ɵɵtext(3, \"Cargando...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction PagoListComponent_table_17_tr_22_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pago_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" Pagado: S/ \", i0.ɵɵpipeBind2(2, 1, pago_r5.montoPagado, \"1.2-2\"), \" \");\n  }\n}\nfunction PagoListComponent_table_17_tr_22_button_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function PagoListComponent_table_17_tr_22_button_24_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const pago_r5 = i0.ɵɵnextContext().$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.registrarPago(pago_r5));\n    });\n    i0.ɵɵelement(1, \"i\", 30);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PagoListComponent_table_17_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"strong\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, PagoListComponent_table_17_tr_22_div_13_Template, 3, 4, \"div\", 21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\")(15, \"span\", 22);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"td\");\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"td\");\n    i0.ɵɵtext(21);\n    i0.ɵɵpipe(22, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"td\");\n    i0.ɵɵtemplate(24, PagoListComponent_table_17_tr_22_button_24_Template, 2, 0, \"button\", 23);\n    i0.ɵɵelementStart(25, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function PagoListComponent_table_17_tr_22_Template_button_click_25_listener() {\n      const pago_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.editar(pago_r5.idPago));\n    });\n    i0.ɵɵelement(26, \"i\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"button\", 26);\n    i0.ɵɵlistener(\"click\", function PagoListComponent_table_17_tr_22_Template_button_click_27_listener() {\n      const pago_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.eliminar(pago_r5.idPago));\n    });\n    i0.ɵɵelement(28, \"i\", 27);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const pago_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"table-danger\", ctx_r2.esVencido(pago_r5));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pago_r5.numeroPago);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", pago_r5.dueno.nombres, \" \", pago_r5.dueno.apellidos, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((pago_r5.mascota == null ? null : pago_r5.mascota.nombre) || \"-\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pago_r5.concepto);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"S/ \", i0.ɵɵpipeBind2(12, 14, pago_r5.monto, \"1.2-2\"), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", pago_r5.montoPagado && pago_r5.montoPagado > 0);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", ctx_r2.getEstadoBadgeClass(pago_r5.estado));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", pago_r5.estado, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(19, 17, pago_r5.fechaEmision, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(22, 20, pago_r5.fechaVencimiento, \"dd/MM/yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", pago_r5.estado !== \"PAGADO\");\n  }\n}\nfunction PagoListComponent_table_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 19)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"N\\u00B0 Pago\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Due\\u00F1o\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8, \"Mascota\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Concepto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Monto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Estado\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\");\n    i0.ɵɵtext(16, \"F. Emisi\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\");\n    i0.ɵɵtext(18, \"F. Vencimiento\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"th\");\n    i0.ɵɵtext(20, \"Acciones\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(21, \"tbody\");\n    i0.ɵɵtemplate(22, PagoListComponent_table_17_tr_22_Template, 29, 23, \"tr\", 20);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(22);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.pagos);\n  }\n}\nfunction PagoListComponent_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31);\n    i0.ɵɵelement(1, \"i\", 32);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"No hay pagos registrados\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let PagoListComponent = /*#__PURE__*/(() => {\n  class PagoListComponent {\n    pagoService;\n    router;\n    pagos = [];\n    filtro = 'TODOS';\n    cargando = false;\n    totalPendiente = 0;\n    filtros = ['TODOS', 'PENDIENTE', 'PAGADO', 'VENCIDO', 'PARCIAL'];\n    constructor(pagoService, router) {\n      this.pagoService = pagoService;\n      this.router = router;\n    }\n    ngOnInit() {\n      this.cargarPagos();\n    }\n    cargarPagos() {\n      this.cargando = true;\n      if (this.filtro === 'TODOS') {\n        this.pagoService.listarTodos().subscribe({\n          next: data => {\n            this.pagos = data;\n            this.cargando = false;\n          },\n          error: error => {\n            console.error('Error al cargar pagos:', error);\n            this.cargando = false;\n          }\n        });\n      } else if (this.filtro === 'PENDIENTE') {\n        this.pagoService.obtenerPendientes().subscribe({\n          next: data => {\n            this.pagos = data;\n            this.cargando = false;\n          },\n          error: error => {\n            console.error('Error al cargar pagos pendientes:', error);\n            this.cargando = false;\n          }\n        });\n      } else if (this.filtro === 'VENCIDO') {\n        this.pagoService.obtenerVencidos().subscribe({\n          next: data => {\n            this.pagos = data;\n            this.cargando = false;\n          },\n          error: error => {\n            console.error('Error al cargar pagos vencidos:', error);\n            this.cargando = false;\n          }\n        });\n      } else {\n        this.pagoService.listarTodos().subscribe({\n          next: data => {\n            this.pagos = data.filter(p => p.estado === this.filtro);\n            this.cargando = false;\n          },\n          error: error => {\n            console.error('Error al cargar pagos:', error);\n            this.cargando = false;\n          }\n        });\n      }\n    }\n    cambiarFiltro(nuevoFiltro) {\n      this.filtro = nuevoFiltro;\n      this.cargarPagos();\n    }\n    nuevo() {\n      this.router.navigate(['/pagos/nuevo']);\n    }\n    editar(id) {\n      this.router.navigate(['/pagos/editar', id]);\n    }\n    registrarPago(pago) {\n      const montoPendiente = pago.monto - (pago.montoPagado || 0);\n      const monto = prompt(`Ingrese el monto a pagar (Pendiente: S/ ${montoPendiente.toFixed(2)}):`);\n      if (monto) {\n        const montoPagado = parseFloat(monto);\n        if (isNaN(montoPagado) || montoPagado <= 0) {\n          alert('Monto inválido');\n          return;\n        }\n        const metodoPago = prompt('Método de pago (EFECTIVO/TARJETA/TRANSFERENCIA):');\n        if (!metodoPago) return;\n        this.pagoService.registrarPago(pago.idPago, montoPagado, metodoPago.toUpperCase()).subscribe({\n          next: () => {\n            alert('Pago registrado exitosamente');\n            this.cargarPagos();\n          },\n          error: error => {\n            console.error('Error al registrar pago:', error);\n            alert('Error al registrar el pago');\n          }\n        });\n      }\n    }\n    eliminar(id) {\n      if (confirm('¿Está seguro de eliminar este pago?')) {\n        this.pagoService.eliminar(id).subscribe({\n          next: () => {\n            alert('Pago eliminado exitosamente');\n            this.cargarPagos();\n          },\n          error: error => {\n            console.error('Error al eliminar:', error);\n            alert('Error al eliminar el pago');\n          }\n        });\n      }\n    }\n    getEstadoBadgeClass(estado) {\n      switch (estado) {\n        case 'PAGADO':\n          return 'bg-success';\n        case 'PENDIENTE':\n          return 'bg-warning';\n        case 'VENCIDO':\n          return 'bg-danger';\n        case 'PARCIAL':\n          return 'bg-info';\n        default:\n          return 'bg-secondary';\n      }\n    }\n    esVencido(pago) {\n      if (!pago.fechaVencimiento) return false;\n      const hoy = new Date();\n      const vencimiento = new Date(pago.fechaVencimiento);\n      return vencimiento < hoy && pago.estado !== 'PAGADO';\n    }\n    static ɵfac = function PagoListComponent_Factory(t) {\n      return new (t || PagoListComponent)(i0.ɵɵdirectiveInject(i1.PagoService), i0.ɵɵdirectiveInject(i2.Router));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PagoListComponent,\n      selectors: [[\"app-pago-list\"]],\n      decls: 19,\n      vars: 4,\n      consts: [[1, \"container-fluid\", \"mt-4\"], [1, \"row\", \"mb-3\"], [1, \"col-md-6\"], [1, \"fas\", \"fa-money-bill-wave\"], [1, \"col-md-6\", \"text-end\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"fas\", \"fa-plus\"], [1, \"col-md-12\"], [\"role\", \"group\", 1, \"btn-group\"], [\"type\", \"button\", \"class\", \"btn\", 3, \"btn-primary\", \"btn-outline-primary\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"card\"], [1, \"card-body\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"table table-hover\", 4, \"ngIf\"], [\"class\", \"text-center text-muted py-4\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", 3, \"click\"], [1, \"text-center\"], [\"role\", \"status\", 1, \"spinner-border\"], [1, \"visually-hidden\"], [1, \"table\", \"table-hover\"], [3, \"table-danger\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-muted small\", 4, \"ngIf\"], [1, \"badge\", 3, \"ngClass\"], [\"class\", \"btn btn-sm btn-success me-1\", \"title\", \"Registrar Pago\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-sm\", \"btn-info\", \"me-1\", 3, \"click\"], [1, \"fas\", \"fa-edit\"], [1, \"btn\", \"btn-sm\", \"btn-danger\", 3, \"click\"], [1, \"fas\", \"fa-trash\"], [1, \"text-muted\", \"small\"], [\"title\", \"Registrar Pago\", 1, \"btn\", \"btn-sm\", \"btn-success\", \"me-1\", 3, \"click\"], [1, \"fas\", \"fa-dollar-sign\"], [1, \"text-center\", \"text-muted\", \"py-4\"], [1, \"fas\", \"fa-inbox\", \"fa-3x\", \"mb-3\"]],\n      template: function PagoListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\");\n          i0.ɵɵelement(4, \"i\", 3);\n          i0.ɵɵtext(5, \" Gesti\\u00F3n de Pagos\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"div\", 4)(7, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function PagoListComponent_Template_button_click_7_listener() {\n            return ctx.nuevo();\n          });\n          i0.ɵɵelement(8, \"i\", 6);\n          i0.ɵɵtext(9, \" Nuevo Pago \");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(10, \"div\", 1)(11, \"div\", 7)(12, \"div\", 8);\n          i0.ɵɵtemplate(13, PagoListComponent_button_13_Template, 2, 5, \"button\", 9);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(14, \"div\", 10)(15, \"div\", 11);\n          i0.ɵɵtemplate(16, PagoListComponent_div_16_Template, 4, 0, \"div\", 12)(17, PagoListComponent_table_17_Template, 23, 1, \"table\", 13)(18, PagoListComponent_div_18_Template, 4, 0, \"div\", 14);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(13);\n          i0.ɵɵproperty(\"ngForOf\", ctx.filtros);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.cargando);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.cargando);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", !ctx.cargando && ctx.pagos.length === 0);\n        }\n      },\n      dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i3.DecimalPipe, i3.DatePipe],\n      styles: [\".btn-group[_ngcontent-%COMP%]{box-shadow:0 2px 4px #0000001a}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.table-danger[_ngcontent-%COMP%]{background-color:#f8d7da!important}.badge[_ngcontent-%COMP%]{font-size:.85rem;padding:.35em .65em}.text-muted.small[_ngcontent-%COMP%]{font-size:.8rem}\"]\n    });\n  }\n  return PagoListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}